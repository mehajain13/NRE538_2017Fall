#Exercise1
install.packages("Lahman")
library(Lahman)
data("Salaries")
money14=subset(Salaries,yearID==2014)
head(money14)
meansVector = function(times, size, dat, varb){
  a = as.numeric(times)
  b = as.numeric(size)
  v = c()
  for(i in 1:a){
    y = sample(dat[,varb],b,replace=TRUE)
    m = mean(y)
    v = c(v,m)
  }
  v
}
sample14_1=meansVector(10,50,money14,"salary")
hist(sample14_1, main = "10 subsamples with 50 values each",probability = TRUE)
avg=mean(sample14_1)
SD=sd(sample14_1)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_1,na.rm = TRUE),col="blue")

sample14_2=meansVector(10,100,money14,"salary")
hist(sample14_2,main="10 subsamples with 100 values each",xlim=c(1000000,6000000),probability = TRUE)
avg=mean(sample14_2)
SD=sd(sample14_2)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_2,na.rm=TRUE),col="red")

sample14_3=meansVector(20,100,money14,"salary")
hist(sample14_3,main="20 subsamples with 100 values each",xlim=c(1000000,6000000),probability = TRUE)
avg=mean(sample14_3)
SD=sd(sample14_3)
legend("topleft", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_3,na.rm=TRUE),col="red")

sample14_4=meansVector(40,100,money14,"salary")
hist(sample14_4,main="40 subsamples with 100 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_4)
SD=sd(sample14_4)
legend("topleft", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_4,na.rm=TRUE),col="red")

sample14_5=meansVector(80,100,money14,"salary")
hist(sample14_5,main="80 subsamples with 100 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_5)
SD=sd(sample14_5)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_5,na.rm=TRUE),col="red")

sample14_6=meansVector(160,100,money14,"salary")
hist(sample14_6,main="160 subsamples with 100 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_6)
SD=sd(sample14_6)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_6,na.rm=TRUE),col="red")

sample14_7=meansVector(320,100,money14,"salary")
hist(sample14_7,main="320 subsamples with 100 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_7)
SD=sd(sample14_7)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_7,na.rm=TRUE),col="red")

sample14_8=meansVector(640,100,money14,"salary")
hist(sample14_8,main="640 subsamples with 100 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_8)
SD=sd(sample14_8)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_8,na.rm=TRUE),col="red")

sample14_9=meansVector(1280,100,money14,"salary")
hist(sample14_9,main="1280 subsamples with 100 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_9)
SD=sd(sample14_9)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_9,na.rm=TRUE),col="red")

sample14_10=meansVector(2560,100,money14,"salary")
hist(sample14_10,main="2560 subsamples with 100 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_10)
SD=sd(sample14_10)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_10,na.rm=TRUE),col="red")

sample14_11=meansVector(1280,10,money14,"salary")
hist(sample14_11,main="1280 subsamples with 10 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_11)
SD=sd(sample14_11)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_11,na.rm=TRUE),col="red")

sample14_12=meansVector(1280,20,money14,"salary")
hist(sample14_12,main="1280 subsamples with 20 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_12)
SD=sd(sample14_12)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_12,na.rm=TRUE),col="red")

sample14_13=meansVector(1280,40,money14,"salary")
hist(sample14_13,main="1280 subsamples with 40 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_13)
SD=sd(sample14_13)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_13,na.rm=TRUE),col="red")

sample14_14=meansVector(1280,80,money14,"salary")
hist(sample14_14,main="1280 subsamples with 80 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_14)
SD=sd(sample14_14)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_14,na.rm=TRUE),col="red")

sample14_15=meansVector(1280,160,money14,"salary")
hist(sample14_15,main="1280 subsamples with 160 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_15)
SD=sd(sample14_15)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_15,na.rm=TRUE),col="red")

sample14_16=meansVector(1280,320,money14,"salary")
hist(sample14_16,main="1280 subsamples with 320 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_16)
SD=sd(sample14_16)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_16,na.rm=TRUE),col="red")

sample14_17=meansVector(1280,640,money14,"salary")
hist(sample14_17,main="1280 subsamples with 640 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_17)
SD=sd(sample14_17)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_17,na.rm=TRUE),col="red")

sample14_18=meansVector(1280,1280,money14,"salary")
hist(sample14_18,main="1280 subsamples with 1280 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_18)
SD=sd(sample14_18)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_18,na.rm=TRUE),col="red")

sample14_19=meansVector(1280,2560,money14,"salary")
hist(sample14_19,main="1280 subsamples with 2560 values each",xlim=c(1000000,7000000),probability = TRUE)
avg=mean(sample14_19)
SD=sd(sample14_19)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(sample14_19,na.rm=TRUE),col="red")


#Exercise2
data("mtcars")
hist(mtcars$mpg)
hist(mtcars$mpg, main = "distribution of mpg", breaks=10)
avg=mean(mtcars$mpg)
SD=sd(mtcars$mpg)
abline(v=avg, col="blue")
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
meansVector = function(times, size, dat, varb){
  a = as.numeric(times)
  b = as.numeric(size)
  v = c()
  for(i in 1:a){
    y = sample(dat[,varb],b,replace=TRUE)
    m = mean(y)
    v = c(v,m)
  }
  v
}
mpg_1=meansVector(10,100,mtcars,"mpg")
hist(mpg_1,main="10 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_1)
SD=sd(mpg_1)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_1,na.rm=TRUE),col="red")

mpg_2=meansVector(20,100,mtcars,"mpg")
hist(mpg_2,main="20 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_2)
SD=sd(mpg_2)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_2,na.rm=TRUE),col="red")

mpg_3=meansVector(40,100,mtcars,"mpg")
hist(mpg_3,main="40 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_3)
SD=sd(mpg_3)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_3,na.rm=TRUE),col="red")

mpg_4=meansVector(80,100,mtcars,"mpg")
hist(mpg_4,main="80 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_4)
SD=sd(mpg_4)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_4,na.rm=TRUE),col="red")

mpg_5=meansVector(160,100,mtcars,"mpg")
hist(mpg_5,main="160 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_5)
SD=sd(mpg_5)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_5,na.rm=TRUE),col="red")

mpg_6=meansVector(320,100,mtcars,"mpg")
hist(mpg_6,main="320 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_6)
SD=sd(mpg_6)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_6,na.rm=TRUE),col="red")

mpg_7=meansVector(640,100,mtcars,"mpg")
hist(mpg_7,main="640 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_7)
SD=sd(mpg_7)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_7,na.rm=TRUE),col="red")

mpg_8=meansVector(1280,100,mtcars,"mpg")
hist(mpg_8,main="1280 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_8)
SD=sd(mpg_8)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_8,na.rm=TRUE),col="red")

mpg_9=meansVector(2560,100,mtcars,"mpg")
hist(mpg_9,main="2560 subsamples with 100 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_9)
SD=sd(mpg_9)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_9,na.rm=TRUE),col="red")

mpg_10=meansVector(1280,10,mtcars,"mpg")
hist(mpg_10,main="1280 subsamples with 10 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_10)
SD=sd(mpg_10)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_10,na.rm=TRUE),col="red")

mpg_11=meansVector(1280,20,mtcars,"mpg")
hist(mpg_11,main="1280 subsamples with 20 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_11)
SD=sd(mpg_11)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_11,na.rm=TRUE),col="red")

mpg_12=meansVector(1280,40,mtcars,"mpg")
hist(mpg_12,main="1280 subsamples with 40 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_12)
SD=sd(mpg_12)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_12,na.rm=TRUE),col="red")

mpg_13=meansVector(1280,80,mtcars,"mpg")
hist(mpg_13,main="1280 subsamples with 80 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_13)
SD=sd(mpg_13)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_13,na.rm=TRUE),col="red")

mpg_14=meansVector(1280,160,mtcars,"mpg")
hist(mpg_14,main="1280 subsamples with 160 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_14)
SD=sd(mpg_14)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_14,na.rm=TRUE),col="red")

mpg_15=meansVector(1280,320,mtcars,"mpg")
hist(mpg_15,main="1280 subsamples with 320 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_15)
SD=sd(mpg_15)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_15,na.rm=TRUE),col="red")

mpg_16=meansVector(1280,640,mtcars,"mpg")
hist(mpg_16,main="1280 subsamples with 640 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_16)
SD=sd(mpg_16)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_16,na.rm=TRUE),col="red")

mpg_17=meansVector(1280,1280,mtcars,"mpg")
hist(mpg_17,main="1280 subsamples with 1280 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_17)
SD=sd(mpg_17)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_17,na.rm=TRUE),col="red")

mpg_18=meansVector(1280,2560,mtcars,"mpg")
hist(mpg_18,main="1280 subsamples with 2560 values each",xlim=c(15,25),probability = TRUE)
avg=mean(mpg_18)
SD=sd(mpg_18)
legend("topright", legend = c(paste0("mean=", avg), paste0("SD=", SD)),text.col=c("blue", "dark green"))
lines(density(mpg_18,na.rm=TRUE),col="red")